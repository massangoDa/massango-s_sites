<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>topng紹介</title>
    <meta content="massangoが作ったtopngというソフトを紹介します。" name="description">
    <meta property="og:title" content="Massango" />
    <meta property="og:description" content="massangoが作ったtopngというソフトを紹介します。" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://massangooo.net" />
    <meta property="og:image" content="https://massangooo.net/mass.png" />
    <meta property="og:site_name" content="Massango" />
    <meta property="og:locale" content="ja_JP"  />
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="footer/footer.css">
    
    <link rel="icon" href="favicon.ico">
    <style>
    #output {
      display: flex;
      flex-wrap: wrap;
    }

    .converted-image {
      margin: 10px;
    }

    #downloadAllLink {
      display: none;
    }

        .reddesuyo {
            color: red;
        }
      </style>
</head>
<body>
    <header>
        <a href="index.html"><div class="logo">MASSANGO</div></a>
        <nav>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">Profile</a></li>
            
            <li><a href="service.html">Services</a></li>
            <li><a href="blog.html">Blog</a></li>
          </ul>
        </nav>
      </header>

      <div class="main-content">
        <div class="box">
            <h2>HEICをPNGに変換</h2>
            <p>ファイルを選択して(複数選択可)、Zip形式でダウンロードするというボタンを押すと、ダウンロードできます。</p>
            <a class="reddesuyo" id="downloadAllLink" style="display: none;" onclick="downloadAll()">Zip形式でダウンロードする</a>
            <input type="file" id="fileInput" accept=".heic" multiple>
            <div id="output"></div>
            <a class="reddesuyo" id="downloadAllLink" style="display: none;" onclick="downloadAll()">Zip形式でダウンロードする</a>
        </div>

      
        </div>


        <footer class="pane-footer">
          <div class="container">
      
              <div id="footernav" class="block-footernav">
                <ul class="block-footernav--item-list-1">
                  <li class="block-footernav--ttl"><a href="index.html">サイト</a></li>
                  <li class="block-footernav--content"><a href="about.html">プロフィール</a></li>
                  <li class="block-footernav--content"><a href="profile.html">プロフィール(アニメ風)</a></li>
                  <li class="block-footernav--content"><a href="service.html">サービス</a></li>
                  <li class="block-footernav--content"><a href="blog.html">ブログ</a></li>
                  <li class="block-footernav--content"><a href="admin">管理者専用</a></li>
                  <!--<li class="block-footernav--content"><a href="#">ここに新しい乱を作るにだ</a></li>-->
                  
                  <!--<li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>-->
                  <!--<li class="block-footernav--other"><a href="#" target="_blank">#</a></li>-->
                </ul>
                <ul class="block-footernav--item-list-1">
                  <li class="block-footernav--ttl"><a href="service.html">サービス</a></li>
                  <li class="block-footernav--content"><a href="service/sitemap/index.html">サイトマップ作成</a></li>
                  <li class="block-footernav--content"><a href="mags.html">MAGs</a></li>
                  <li class="block-footernav--content"><a href="3dgs.html">3BGs</a></li>
                  <li class="block-footernav--content"><a href="service/keisan/keisan.html">自動計算</a></li>
                  <li class="block-footernav--content"><a href="topng.html">topng</a></li>
      
                  <!--<li class="block-footernav--ttl block-footernav--other"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>
                  <li class="block-footernav--content"><a href="#">#</a></li>-->
                </ul>
                <ul class="block-footernav--item-list-2">
                  <li><a href="pagesabout.html">はじめての方へ</a></li>
                  <li><a href="form/form.html">お問い合わせ</a></li>
                  <!--<li><a href="#">よくある質問</a></li>-->
                  <li><a href="sitepolicy.html">ウェブサイトご利用規約</a></li>
                  <li><a href="bunner.html">サイトのバナー</a></li>
                </ul>
                <ul class="block-footernav--item-list-3">
                  <li><a target="_blank" href="https://hassy1216.github.io/"><img src="https://raw.githubusercontent.com/hassy1216/hassy1216.github.io/main/sketch-1696510507951.png" alt="hassy" width="200px"></a></li>
                  <li><a target="_blank" href="https://m1ntooo.com"><img src="https://m1ntooo.com/Banner/m1ntooo.png" alt="m1ntooo" width="200px"></a></li>
                  <li><a target="_blank" href="https://rumiserver.com/"><img src="https://rumiserver.com/Asset/rumisan_room/BANNR.png" alt="るみ" width="200px"></a></li>
                  <li><a target="_blank" href="topng.html"><img src="koukoku/topng_koukoku.png" alt="topngの広告" width="200px"></a></li>
                </ul>
              </div>
          </div>

  </div>




  <script>
    document.getElementById('fileInput').addEventListener('change', handleFileSelect);

    function handleFileSelect(event) {
      const files = event.target.files;
      if (files.length > 0) {
        convertAndDisplayImages(Array.from(files));
      }
    }

    function convertAndDisplayImages(files) {
      const outputDiv = document.getElementById('output');
      outputDiv.innerHTML = ''; // Clear previous images

      files.forEach((file, index) => {
        const reader = new FileReader();

        reader.onload = function (e) {
          const dataURL = e.target.result;
          const img = new Image();

          img.onload = function () {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, img.width, img.height);
            const pngDataUrl = canvas.toDataURL('image/png');

            // Display the converted PNG image
            const imgElement = document.createElement('img');
            imgElement.src = pngDataUrl;
            imgElement.alt = `Converted PNG ${index + 1}`;
            imgElement.classList.add('converted-image');
            outputDiv.appendChild(imgElement);

            // Display the download button for each image
            const downloadLink = document.createElement('a');
            downloadLink.href = pngDataUrl;
            downloadLink.download = `converted_image_${index + 1}.png`;
            downloadLink.innerHTML = `Download PNG ${index + 1}`;
            outputDiv.appendChild(downloadLink);

            // Display the download all button when all images are processed
            if (index === files.length - 1) {
              const downloadAllLink = document.getElementById('downloadAllLink');
              downloadAllLink.style.display = 'block';
            }
          };

          img.src = dataURL;
        };

        reader.readAsDataURL(file);
      });
    }

    function downloadAll() {
      const files = document.getElementById('fileInput').files;
      const zip = new JSZip();

      Array.from(files).forEach((file, index) => {
        const reader = new FileReader();
        reader.onload = function (e) {
          const dataURL = e.target.result;
          const img = new Image();

          img.onload = function () {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, img.width, img.height);
            const pngDataUrl = canvas.toDataURL('image/png');

            // Add the converted image to the ZIP file
            const fileName = `converted_image_${index + 1}.png`;
            zip.file(fileName, pngDataUrl.split(',')[1], { base64: true });

            // Download the ZIP file after processing all images
            if (index === files.length - 1) {
              zip.generateAsync({ type: 'blob' })
                .then(function (content) {
                  saveAs(content, 'converted_images.zip');
                });
            }
          };

          img.src = dataURL;
        };

        reader.readAsDataURL(file);
      });
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.5/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>


</body>
</html>

